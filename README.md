# Capstone

## Project Layout

This repository consists of files for three major application components:

### Next

The frontend portion of the application. This component utilizes the following directories:

- `compononents`
- `pages`
- `public`
- `theme`
- `node_modules` (generated by NPM)
- `.next` (generated by Next and ignored from source control)

### Hasura

This is the GraphQL engine for the application, functionally the backend API layer. All of the files required by Hasura are in the `hasura` directory.

### Now Lambdas

These lambda functions are used by Hasura to do reactive data processing. These are located in the `api` directory, and they share `node_modules` with Next.

## Development

You need to launch the following services to develop this application:

- Docker Compose
- Hasura console
- `now dev`

First, from the root of the project, launch the Hasura GraphQL Engine and Postgres using Docker Compose:

```sh
docker-compose up
```

This will make Hasura available at `http://localhost:8080`. **NOT** the Hasura console, mind you. You'll use this endpoint to communicate with Hasura from the Next app using URQL.

Next, open another shell and launch the Hasura console:

```sh
# Install the console
npm i -g hasura-cli

# Navigate into the Hasura project directory
cd hasura

# Launch the console
hasura console --admin-key peeristcapstone
```

We launch the console using the Hasura CLI so that Hasura can save metadata to your local disk, which can then be saved into version control.

Finally, launch Next and the lambda functions for development:

```sh
# Install the Now CLI
npm i -g now

# Launch the development servers
now dev
```
